# Web Region & Audience Analyzer

ä¸€ä¸ªç”¨äºåˆ†æç½‘é¡µå½’å±åœ°åŒºã€ç›®æ ‡å—ä¼—å’Œä¸»è¦è¯­è¨€çš„å¤šä¿¡å·èåˆåˆ†æå·¥å…·ã€‚é€šè¿‡ IP åœ°ç†å®šä½ã€HTML å…ƒæ•°æ®ã€é¡µé¢å†…å®¹ä¿¡å·ï¼ˆè´§å¸ã€ç”µè¯å·ç ã€ç¤¾äº¤åª’ä½“ï¼‰ã€ä»¥åŠè¯­è¨€æ£€æµ‹ç­‰å¤šç»´åº¦æ•°æ®æºï¼Œç»™å‡ºå¸¦ç½®ä¿¡åº¦è¯„åˆ†çš„ç»“æ„åŒ–åˆ¤æ–­ç»“æœã€‚

**é¢å‘è·¨å¢ƒå¤šè¯­è¨€ç½‘ç«™**ï¼ˆå¦‚ Shopify å…¨çƒåº—é“ºã€SaaS å¤šè¯­è¨€ç«™ç‚¹ï¼‰ï¼Œä¸é’ˆå¯¹å›½å†…ä¸­æ–‡ç½‘ç«™ã€‚

## åŠŸèƒ½æ¦‚è§ˆ

- **åœ°åŒºå½’å±åˆ¤æ–­** â€” åˆ¤æ–­ç½‘é¡µæ‰€å±å›½å®¶/åœ°åŒºï¼ˆISO 3166-1 alpha-2ï¼‰
- **ç›®æ ‡å—ä¼—æ¨æ–­** â€” ç”Ÿæˆäººç±»å¯è¯»çš„å—ä¼—æè¿°ï¼ˆå¦‚ "Japanese-speaking audience in Japan"ï¼‰
- **ä¸»è¦è¯­è¨€æ£€æµ‹** â€” è¯†åˆ«é¡µé¢ä½¿ç”¨çš„ä¸»è¦è¯­è¨€åŠç½®ä¿¡åº¦
- **å¤šä¿¡å·èåˆè¯„åˆ†** â€” ç»¼åˆ 6 ç±»ä¿¡å·æºåŠ æƒè®¡ç®—ï¼Œè¾“å‡º 0.0â€“1.0 ç½®ä¿¡åº¦åˆ†æ•°
- **è¯æ®é“¾å®Œæ•´è¾“å‡º** â€” æ¯é¡¹åˆ¤æ–­éƒ½é™„å¸¦åŸå§‹è¯æ®ï¼Œä¾¿äºäººå·¥å¤æ ¸
- **ğŸ†• è·¨å¢ƒæœ¬åœ°åŒ–ä¼˜åŒ–å»ºè®®** â€” è‡ªåŠ¨å®¡è®¡ hreflangã€locale å£°æ˜ã€ä¿¡å·ä¸€è‡´æ€§ã€å¸‚åœºé€‚é…ç­‰ï¼Œè¾“å‡ºè¯„åˆ†ï¼ˆAâ€“Fï¼‰å’Œå…·ä½“ä¿®å¤æ–¹æ¡ˆ
- **ğŸ†• å¤šé¡µé¢ç«™ç‚¹çˆ¬å–** â€” è‡ªåŠ¨çˆ¬å–å¹¶åˆ†ææ•´ä¸ªç«™ç‚¹ï¼ˆæœ€å¤š 3 å±‚æ·±åº¦ï¼Œ50 ä¸ªé¡µé¢ï¼‰ï¼Œèšåˆå…¨ç«™åˆ†æç»“æœ
- **ğŸ†• AI å†…å®¹è´¨é‡åˆ†æ** â€” ä½¿ç”¨ LLM æ·±åº¦åˆ†æé¡µé¢å†…å®¹ï¼Œè¯„ä¼°è¯­è¨€è´¨é‡ã€æ–‡åŒ–é€‚é…åº¦ã€è´­ä¹°ä¹ æƒ¯åŒ¹é…åº¦

## ä¿¡å·æºæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Signal Fusion                      â”‚
â”‚                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ HTML Meta â”‚  â”‚ Content  â”‚  â”‚  IP Geolocation   â”‚  â”‚
â”‚  â”‚ Signals   â”‚  â”‚ Signals  â”‚  â”‚  (ip-api.com)     â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ lang     â”‚  â”‚ Currency â”‚  â”‚ Country/City      â”‚  â”‚
â”‚  â”‚ og:localeâ”‚  â”‚ Phone    â”‚  â”‚ ISP/Org           â”‚  â”‚
â”‚  â”‚ hreflang â”‚  â”‚ Social   â”‚  â”‚ CDN Detection     â”‚  â”‚
â”‚  â”‚ TLD      â”‚  â”‚ Media    â”‚  â”‚                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚         Language Detection                    â”‚    â”‚
â”‚  â”‚  NLP Cloud API (ä¼˜å…ˆ) / langdetect (ç¦»çº¿å›é€€)  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                      â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚               Weighted Scoring Engine                â”‚
â”‚  TLD(1.0) + Lang(0.9) + Locale(0.8) + LangDet(0.6) â”‚
â”‚  + IP(0.4/0.2) + Currency(0.3) + Phone(0.3) + ...   â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚                        â†“                             â”‚
â”‚              Structured JSON Output                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## å®‰è£…

### ç¯å¢ƒè¦æ±‚

- Python 3.8+

### å®‰è£…ä¾èµ–ï¼ˆæ¨èï¼‰

```bash
pip install beautifulsoup4 langdetect
```

> è„šæœ¬åœ¨æ— ä¾èµ–ç¯å¢ƒä¸‹ä¹Ÿå¯è¿è¡Œï¼ˆé™çº§æ¨¡å¼ï¼‰ï¼Œä½†å®‰è£…ä¸Šè¿°åŒ…å¯æ˜¾è‘—æå‡ HTML è§£æå’Œè¯­è¨€æ£€æµ‹æ•ˆæœã€‚

## ç”¨æ³•

### åŸºç¡€åˆ†æ

```bash
python3 scripts/analyze_webpage.py https://www.example.com
```

### å‘½ä»¤è¡Œå‚æ•°

#### åŸºç¡€å‚æ•°

| å‚æ•° | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|--------|
| `url` | è¦åˆ†æçš„ç½‘é¡µ URLï¼ˆå¿…å¡«ï¼‰ | â€” |
| `--no-ip-geo` | ç¦ç”¨ IP åœ°ç†å®šä½ | å¯ç”¨ |
| `--nlpcloud-token TOKEN` | NLP Cloud API Tokenï¼ˆæ›´é«˜ç²¾åº¦è¯­è¨€æ£€æµ‹ï¼‰ | æ—  |
| `--timeout N` | HTTP è¯·æ±‚è¶…æ—¶ç§’æ•° | 15 |
| `--output FILE` / `-o FILE` | è¾“å‡ºåˆ°æ–‡ä»¶ | JSON: stdoutï¼›Markdown: è‡ªåŠ¨ä¿å­˜åˆ°ä¸‹è½½ç›®å½• |
| `--format {json,markdown}` | è¾“å‡ºæ ¼å¼ | json |
| `--no-recommendations` | ç¦ç”¨è·¨å¢ƒä¼˜åŒ–å»ºè®®è¾“å‡º | å¯ç”¨ |

#### å¤šé¡µé¢çˆ¬å–å‚æ•°

| å‚æ•° | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|--------|
| `--crawl` | å¯ç”¨å¤šé¡µé¢ç«™ç‚¹çˆ¬å–æ¨¡å¼ | ç¦ç”¨ |
| `--max-depth N` | æœ€å¤§çˆ¬å–æ·±åº¦ | 3 |
| `--max-pages N` | æœ€å¤§çˆ¬å–é¡µé¢æ•° | 50 |

#### AI å†…å®¹åˆ†æå‚æ•°

| å‚æ•° | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|--------|
| `--ai-api-base URL` | OpenAI å…¼å®¹ API åœ°å€ï¼ˆæˆ–ä½¿ç”¨ `AI_API_BASE` ç¯å¢ƒå˜é‡ï¼‰ | æ—  |
| `--ai-api-key KEY` | API å¯†é’¥ï¼ˆæˆ–ä½¿ç”¨ `AI_API_KEY` ç¯å¢ƒå˜é‡ï¼‰ | æ—  |
| `--ai-model MODEL` | AI æ¨¡å‹åç§° | gpt-4o |
| `--target-audience TEXT` | æ‰‹åŠ¨æŒ‡å®šç›®æ ‡äººç¾¤ï¼ˆä¸å¡«åˆ™ç”± AI/è§„åˆ™è‡ªåŠ¨è¯†åˆ«ï¼‰ | æ—  |

### ä½¿ç”¨ç¤ºä¾‹

**åˆ†æå•ä¸ªé¡µé¢ï¼š**
```bash
python3 scripts/analyze_webpage.py https://www.shein.com
```

**åˆ†ææ•´ä¸ªç«™ç‚¹ï¼ˆå¤šé¡µé¢çˆ¬å–ï¼‰ï¼š**
```bash
python3 scripts/analyze_webpage.py https://www.shein.com --crawl
```

**å¤šé¡µé¢çˆ¬å– + AI å†…å®¹åˆ†æï¼ˆæ¨èï¼‰ï¼š**
```bash
python3 scripts/analyze_webpage.py https://www.shein.com --crawl \
  --ai-api-base https://api.openai.com/v1 \
  --ai-api-key YOUR_API_KEY
```

**æ‰‹åŠ¨æŒ‡å®šç›®æ ‡äººç¾¤å¹¶åš persona åŒ¹é…åˆ†æï¼š**
```bash
python3 scripts/analyze_webpage.py https://example.com --crawl \
  --target-audience "åŒ—ç¾ 25-35 å²å¥³æ€§å¿«æ—¶å°šç”¨æˆ·"
```

**ä½¿ç”¨ç¯å¢ƒå˜é‡é…ç½® AIï¼š**
```bash
export AI_API_BASE=https://api.openai.com/v1
export AI_API_KEY=sk-your-key-here
python3 scripts/analyze_webpage.py https://www.shein.com --crawl
```

**è‡ªå®šä¹‰çˆ¬å–å‚æ•°ï¼š**
```bash
python3 scripts/analyze_webpage.py https://example.com --crawl \
  --max-depth 2 --max-pages 10 -o analysis.json
```

**å¯¼å‡º Markdownï¼ˆé»˜è®¤ä¿å­˜åˆ°ä¸‹è½½ç›®å½•ï¼‰ï¼š**
```bash
python3 scripts/analyze_webpage.py https://example.com --format markdown
```

**å¯¼å‡º Markdownï¼ˆè‡ªå®šä¹‰ä¿å­˜è·¯å¾„ï¼‰ï¼š**
```bash
python3 scripts/analyze_webpage.py https://example.com --format markdown -o report.md
```

**ä½¿ç”¨ NLP Cloud å¢å¼ºè¯­è¨€æ£€æµ‹ï¼š**
```bash
python3 scripts/analyze_webpage.py https://www.spiegel.de --nlpcloud-token YOUR_TOKEN
```

**ä»…åˆ†æé¡µé¢å†…å®¹ä¿¡å·ï¼ˆä¸æŸ¥ IPï¼‰ï¼š**
```bash
python3 scripts/analyze_webpage.py https://www.yahoo.co.jp --no-ip-geo
```

## è¾“å‡ºæ ¼å¼

- `--format json`ï¼ˆé»˜è®¤ï¼‰ï¼šè¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºï¼Œå¯ç”¨ `-o` ä¿å­˜æ–‡ä»¶ã€‚
- `--format markdown`ï¼šæœªæŒ‡å®š `-o` æ—¶è‡ªåŠ¨ä¿å­˜åˆ° `~/Downloads/web-region-audience-report-<åŸŸå>-<æ—¶é—´æˆ³>.md`ã€‚

```jsonc
{
  "url": "https://www.yahoo.co.jp",
  "analyzedAt": "2026-02-10T06:42:10Z",
  "result": {
    "primaryRegion": "JP",                              // ISO å›½å®¶ä»£ç 
    "primaryRegionName": "Japan",                       // å›½å®¶åç§°
    "primaryLanguage": "ja",                            // è¯­è¨€ä»£ç 
    "primaryLanguageName": "Japanese",                  // è¯­è¨€åç§°
    "likelyAudience": "Japanese-speaking audience in Japan",  // å—ä¼—æè¿°
    "regionConfidence": 0.67,                           // åœ°åŒºç½®ä¿¡åº¦ (0.0-1.0)
    "languageConfidence": 1.0,                          // è¯­è¨€ç½®ä¿¡åº¦
    "signalBreakdown": { "JP": 3.0 }                   // å„åœ°åŒºå¾—åˆ†æ˜ç»†
  },
  "evidence": {
    "htmlSignals": {
      "lang": "ja",                    // <html lang="...">
      "metaLocale": null,              // <meta property="og:locale">
      "metaLanguage": null,            // <meta http-equiv="content-language">
      "metaGeoRegion": null,           // <meta name="geo.region">
      "charset": "utf-8",
      "hreflangTags": [],              // <link rel="alternate" hreflang="...">
      "tld": ".jp"                     // åŸŸåé¡¶çº§åŸŸ
    },
    "contentSignals": {
      "currencyCodes": [],             // é¡µé¢ä¸­å‡ºç°çš„è´§å¸ä»£ç  (USD, CNY...)
      "currencySymbols": [],           // è´§å¸ç¬¦å· ($, Â¥, â‚¬...)
      "phoneFormats": [],              // å›½é™…ç”µè¯åŒºå· (+86, +1...)
      "socialMediaSignals": [          // åœ°åŒºæ€§ç¤¾äº¤åª’ä½“é“¾æ¥
        { "domain": "line.me", "region": "JP" }
      ]
    },
    "ipGeolocation": {                 // IP åœ°ç†å®šä½ç»“æœ (ip-api.com)
      "country": "Japan",
      "countryCode": "JP",
      "city": "Chiyoda City",
      "isp": "YAHOO"
    },
    "languageDetection": {             // è¯­è¨€æ£€æµ‹ç»“æœ
      "results": [{ "lang": "ja", "confidence": 0.999999 }],
      "method": "langdetect"
    }
  },
  "errors": [],                        // è‡´å‘½é”™è¯¯
  "warnings": [],                      // éè‡´å‘½è­¦å‘Š
  "optimization": {                    // è·¨å¢ƒä¼˜åŒ–å»ºè®®
    "summary": {
      "score": 86,                     // è¯„åˆ† (0-100)
      "grade": "A",                    // ç­‰çº§ (A-F)
      "totalIssues": 3,
      "critical": 0,
      "warnings": 1,
      "info": 2
    },
    "recommendations": [
      {
        "severity": "warning",
        "category": "locale-declaration",
        "issue": "Missing og:locale meta tag...",
        "recommendation": "Add og:locale for correct social media...",
        "codeExample": "<meta property=\"og:locale\" content=\"en_US\" />"
      }
    ]
  },
  "aiContentAnalysis": {              // AI å†…å®¹è´¨é‡åˆ†æï¼ˆéœ€è¦ --ai-api-base å’Œ --ai-api-keyï¼‰
    "inferredProductType": "E-commerce fashion retailer",
    "languageQuality": {
      "score": 8.5,                   // 1-10 åˆ†ï¼Œ10 ä¸ºå®Œç¾æ¯è¯­æ°´å¹³
      "isNativeLevel": true,
      "machineTranslationDetected": false,
      "details": "Natural, fluent Japanese with appropriate honorifics..."
    },
    "regionFit": {
      "score": 9.0,                   // 1-10 åˆ†ï¼Œ10 ä¸ºå®Œç¾é€‚é…
      "culturallyApproriate": true,
      "issues": [],
      "strengths": ["Uses local currency JPY", "References local holidays"]
    },
    "contentProductAlignment": {
      "score": 8.0,
      "details": "Clear value proposition for target audience..."
    },
    "suggestions": [
      "Consider adding more local payment methods like PayPay",
      "Include references to Japanese fashion trends"
    ]
  },
  "personaAnalysis": {                // äººç¾¤ç”»åƒä¸ç½‘ç«™åŒ¹é…åº¦åˆ†æï¼ˆå§‹ç»ˆè¾“å‡ºï¼Œä¼˜å…ˆç”¨ AIï¼‰
    "audience": {
      "source": "user_input | ai_inferred | rule_based",
      "finalAudience": "åŒ—ç¾ 25-35 å²å¥³æ€§å¿«æ—¶å°šç”¨æˆ·"
    },
    "regionalPersona": {
      "personaLabel": "US price-sensitive mobile-first fashion shopper",
      "traits": ["Price-sensitive", "Mobile-first", "Trend-driven"]
    },
    "personaFit": {
      "score": 7.6,                   // 1-10 åˆ†
      "isFit": true,
      "summary": "ç½‘ç«™æ•´ä½“è¾ƒç¬¦åˆè¯¥äººç¾¤é¢„æœŸã€‚"
    }
  }
}
```

## AI å†…å®¹è´¨é‡åˆ†æ

å¯ç”¨ AI åˆ†æåï¼ˆ`--ai-api-base` å’Œ `--ai-api-key`ï¼‰ï¼Œå·¥å…·ä¼šä½¿ç”¨ LLM æ·±åº¦åˆ†æé¡µé¢å†…å®¹ï¼š

### åˆ†æç»´åº¦

1. **è¯­è¨€è´¨é‡** (languageQuality)
   - è¯„åˆ† 1-10ï¼ˆ10 ä¸ºå®Œç¾æ¯è¯­æ°´å¹³ï¼‰
   - æ˜¯å¦è¾¾åˆ°æ¯è¯­æ°´å¹³
   - æ˜¯å¦æ£€æµ‹åˆ°æœºå™¨ç¿»è¯‘ç—•è¿¹
   - è¯­æ³•è´¨é‡ã€è‡ªç„¶åº¦ã€è¯æ±‡é€‚å½“æ€§è¯„ä¼°

2. **åŒºåŸŸé€‚é…åº¦** (regionFit)
   - è¯„åˆ† 1-10ï¼ˆ10 ä¸ºå®Œç¾é€‚é…ç›®æ ‡åœ°åŒºï¼‰
   - æ–‡åŒ–é€‚åº”æ€§è¯„ä¼°
   - å…·ä½“é—®é¢˜åˆ—è¡¨ï¼ˆå¦‚ï¼šä¸ºå¾·å›½å—ä¼—ä½¿ç”¨ç¾å¼æ—¥æœŸæ ¼å¼ï¼‰
   - ä¼˜ç‚¹åˆ—è¡¨ï¼ˆå¦‚ï¼šæ­£ç¡®ä½¿ç”¨æœ¬åœ°è´§å¸ï¼‰

3. **å†…å®¹äº§å“å¯¹é½** (contentProductAlignment)
   - è¯„åˆ† 1-10ï¼ˆ10 ä¸ºå†…å®¹å®Œç¾åŒ¹é…äº§å“å®šä½ï¼‰
   - æ–‡æ¡ˆã€è¯­æ°”ã€ä¿¡æ¯ä¼ é€’æ˜¯å¦åŒ¹é…äº§å“/æœåŠ¡
   - ä»·å€¼ä¸»å¼ å¯¹ç›®æ ‡å—ä¼—æ˜¯å¦æ¸…æ™°

4. **æ”¹è¿›å»ºè®®** (suggestions)
   - å¯æ“ä½œçš„æœ¬åœ°åŒ–è´¨é‡æ”¹è¿›å»ºè®®
   - é’ˆå¯¹ç›®æ ‡å¸‚åœºçš„å…·ä½“ä¼˜åŒ–æ–¹å‘

5. **Persona åŒ¹é…åˆ†æ** (personaAnalysis)
   - å…ˆç¡®å®šç›®æ ‡äººç¾¤ï¼ˆç”¨æˆ·è¾“å…¥ä¼˜å…ˆï¼Œå¦åˆ™ AI æ¨æ–­ï¼‰
   - æŒ‰ç›®æ ‡åœ°åŒºç”Ÿæˆäººç¾¤ personaï¼ˆç‰¹å¾ã€åŠ¨æœºã€ç—›ç‚¹ã€è´­ä¹°é©±åŠ¨ï¼‰
   - è¯„ä¼°ç½‘ç«™ä¸è¯¥ persona çš„åŒ¹é…åº¦ï¼ˆscore / isFit / summaryï¼‰

### æ”¯æŒçš„ API

- OpenAI API (gpt-4o, gpt-4-turbo, gpt-3.5-turbo)
- Azure OpenAI
- ä»»ä½• OpenAI å…¼å®¹çš„ APIï¼ˆå¦‚ Anthropic Claude via proxyï¼‰

### ä½¿ç”¨ç¤ºä¾‹

```bash
# ä½¿ç”¨ OpenAI
python3 scripts/analyze_webpage.py https://example.com --crawl \
  --ai-api-base https://api.openai.com/v1 \
  --ai-api-key sk-your-key

# ä½¿ç”¨ç¯å¢ƒå˜é‡
export AI_API_BASE=https://api.openai.com/v1
export AI_API_KEY=sk-your-key
python3 scripts/analyze_webpage.py https://example.com --crawl

# æŒ‡å®šæ¨¡å‹
python3 scripts/analyze_webpage.py https://example.com \
  --ai-api-base https://api.openai.com/v1 \
  --ai-api-key sk-your-key \
  --ai-model gpt-4-turbo
```

## å¤šé¡µé¢ç«™ç‚¹åˆ†æ

ä½¿ç”¨ `--crawl` å‚æ•°å¯ç”¨å¤šé¡µé¢çˆ¬å–æ¨¡å¼ï¼š

### å·¥ä½œåŸç†

1. ä»èµ·å§‹ URL å¼€å§‹çˆ¬å–
2. æå–é¡µé¢ä¸­çš„æ‰€æœ‰é“¾æ¥
3. ä»…çˆ¬å–åŒåŸŸåä¸‹çš„é¡µé¢
4. å¹¿åº¦ä¼˜å…ˆéå†ï¼Œæœ€å¤š 3 å±‚æ·±åº¦
5. æœ€å¤šåˆ†æ 50 ä¸ªé¡µé¢
6. æ¯ä¸ªé¡µé¢ç‹¬ç«‹åˆ†æï¼Œæœ€åèšåˆç»“æœ

### èšåˆç»“æœ

- **siteResult**: å…¨ç«™åœ°åŒº/è¯­è¨€åˆ¤æ–­ï¼ˆç»¼åˆæ‰€æœ‰é¡µé¢ä¿¡å·ï¼‰
- **siteOptimization**: å…¨ç«™ä¼˜åŒ–å»ºè®®ï¼ˆèšåˆæ‰€æœ‰é¡µé¢é—®é¢˜ï¼‰
- **aiContentAnalysis**: AI åˆ†æèšåˆï¼ˆå¹³å‡åˆ†æ•° + ç»¼åˆå»ºè®®ï¼‰
- **personaAnalysis**: å…¨ç«™äººç¾¤ç”»åƒä¸åŒ¹é…åº¦èšåˆç»“æœ
- **pages[]**: æ¯ä¸ªé¡µé¢çš„è¯¦ç»†åˆ†æç»“æœ

### ä½¿ç”¨åœºæ™¯

- åˆ†ææ•´ä¸ªç½‘ç«™çš„æœ¬åœ°åŒ–è´¨é‡
- æ£€æŸ¥ä¸åŒé¡µé¢çš„è¯­è¨€ä¸€è‡´æ€§
- å‘ç°å…¨ç«™æ€§çš„æœ¬åœ°åŒ–é—®é¢˜
- è¯„ä¼°ç½‘ç«™æ•´ä½“çš„è·¨å¢ƒé€‚é…åº¦

```

## è·¨å¢ƒä¼˜åŒ–å»ºè®®è§£è¯»

å·¥å…·ä¼šå¯¹ä»¥ä¸‹ç»´åº¦è¿›è¡Œå®¡è®¡å¹¶ç»™å‡ºè¯„åˆ†ï¼š

1. **hreflang é…ç½®** (Critical) â€” æ˜¯å¦æ­£ç¡®é…ç½®å¤šè¯­è¨€/å¤šåœ°åŒºé“¾æ¥ï¼Œæ˜¯å¦æœ‰ `x-default`
2. **Locale å£°æ˜** (Critical) â€” `<html lang>`, `og:locale`, `content-language` æ˜¯å¦å­˜åœ¨ä¸”ä¸€è‡´
3. **å¸‚åœºé€‚é…åº¦** (Warning) â€” ç›®æ ‡å¸‚åœºçš„è´§å¸ã€ç”µè¯æ ¼å¼ã€ç¤¾äº¤åª’ä½“æ˜¯å¦æœ¬åœ°åŒ–ï¼Œ**æ˜¯å¦æ”¯æŒæœ¬åœ°æ”¯ä»˜æ–¹å¼**ï¼ˆå¦‚å¾·å›½ Sofortã€è·å…° iDEALã€å·´è¥¿ Pixï¼‰
4. **æ–‡åŒ–é€‚åº”æ€§** (Info) â€” æ‹¼å†™ä¹ æƒ¯ï¼ˆç¾å¼ vs è‹±å¼ï¼‰å’Œè®¡é‡å•ä½ï¼ˆå…¬åˆ¶ vs è‹±åˆ¶ï¼‰æ˜¯å¦ç¬¦åˆç›®æ ‡å—ä¼—ä¹ æƒ¯
5. **ç”¨æˆ·ä½“éªŒ (UX)** (Critical/Warning) â€” ç§»åŠ¨ç«¯è§†å£é…ç½®ã€è¡¨å•è¾“å…¥ç±»å‹ä¼˜åŒ–ï¼ˆemail/telï¼‰ã€å›¾ç‰‡ Alt æ–‡æœ¬
6. **æœåŠ¡å™¨/CDN** (Info) â€” æœåŠ¡å™¨ä½ç½®æ˜¯å¦ä¸ç›®æ ‡å—ä¼—åŒ¹é…ï¼Œæ˜¯å¦ä½¿ç”¨äº† CDN
5. **å­—ç¬¦é›†** (Warning) â€” æ˜¯å¦ä½¿ç”¨ UTF-8 ä»¥æ”¯æŒå¤šè¯­è¨€

| ç­‰çº§ | åˆ†æ•° | å«ä¹‰ |
|------|------|------|
| **A** | 80-100 | ä¼˜ç§€ï¼Œä»…æœ‰å°‘é‡éå…³é”®å»ºè®® |
| **B** | 60-79 | è‰¯å¥½ï¼Œå­˜åœ¨ä¸€äº›è­¦å‘Šé¡¹ |
| **C** | 40-59 | åŠæ ¼ï¼Œå­˜åœ¨è¾ƒå¤šé—®é¢˜ |
| **D** | 20-39 | è¾ƒå·®ï¼Œå­˜åœ¨å…³é”®ç¼ºå¤±ï¼ˆå¦‚æ—  hreflangï¼‰ |
| **F** | 0-19 | æå·®ï¼ŒåŸºæœ¬æœªåšæœ¬åœ°åŒ–é…ç½® |

## ç½®ä¿¡åº¦è§£è¯»

| åŒºé—´ | å«ä¹‰ | å…¸å‹åœºæ™¯ |
|------|------|----------|
| **> 0.6** | é«˜ç½®ä¿¡åº¦ | å¤šä¿¡å·ä¸€è‡´ï¼ˆTLD + lang + IP + è¯­è¨€æ£€æµ‹éƒ½æŒ‡å‘åŒä¸€åœ°åŒºï¼‰ |
| **0.3 â€“ 0.6** | ä¸­ç­‰ç½®ä¿¡åº¦ | éƒ¨åˆ†ä¿¡å·ä¸€è‡´ï¼Œéƒ¨åˆ†ç¼ºå¤± |
| **< 0.3** | ä½ç½®ä¿¡åº¦ | å…¨çƒåŒ–ç«™ç‚¹ï¼ˆ.com + è‹±è¯­ + CDNï¼‰ã€ä¿¡å·å†²çª |

## åŠ æƒè¯„åˆ†è§„åˆ™

| ä¿¡å· | æƒé‡ | è¯´æ˜ |
|------|------|------|
| TLDï¼ˆåŸŸååç¼€ï¼‰ | 1.0 | å¼ºä¿¡å·ï¼Œå¦‚ `.de`â†’å¾·å›½ã€`.jp`â†’æ—¥æœ¬ |
| `<html lang="xx-YY">` å«åœ°åŒº | 0.9 | æ˜¾å¼å£°æ˜ï¼Œå¦‚ `zh-CN` |
| `<html lang="xx">` æ— åœ°åŒº | 0.7 | é€šè¿‡è¯­è¨€æ¨æ–­åœ°åŒºï¼Œå¦‚ `ja`â†’æ—¥æœ¬ |
| `og:locale` | 0.8 | OpenGraph åœ°åŒºå£°æ˜ |
| `content-language` | 0.7 | HTTP-equiv è¯­è¨€å£°æ˜ |
| è¯­è¨€æ£€æµ‹ç»“æœ | 0.6 Ã— conf | ç»Ÿè®¡æ£€æµ‹ï¼ŒæŒ‰ç½®ä¿¡åº¦ç¼©æ”¾ |
| IP åœ°ç†å®šä½ | 0.4 / 0.2 | é CDN ä¸º 0.4ï¼Œæ£€æµ‹åˆ° CDN é™ä¸º 0.2 |
| è´§å¸ä»£ç /ç¬¦å· | 0.3 | æ¯ç§å”¯ä¸€è´§å¸ |
| ç”µè¯åŒºå· | 0.3 | æ¯ç§å”¯ä¸€åŒºå· |
| ç¤¾äº¤åª’ä½“åŸŸå | 0.3 | åœ°åŒºæ€§ç¤¾äº¤å¹³å°ï¼ˆå¾®ä¿¡ã€VKã€LINE ç­‰ï¼‰ |

## æŠ€æœ¯ç‰¹æ€§

- **é›¶å¿…éœ€ä¾èµ–** â€” çº¯ Python stdlib å³å¯è¿è¡Œï¼Œ`beautifulsoup4` å’Œ `langdetect` ä¸ºå¯é€‰å¢å¼º
- **SSL å®¹é”™** â€” åŒç­–ç•¥ SSLï¼ˆæ ‡å‡† â†’ å®½æ¾å›é€€ï¼‰ï¼Œè§£å†³éƒ¨åˆ†ç«™ç‚¹è¯ä¹¦é—®é¢˜
- **CDN æ„ŸçŸ¥** â€” è‡ªåŠ¨æ£€æµ‹ Cloudflare/Akamai/Fastly ç­‰ CDNï¼Œé™ä½ IP ä¿¡å·æƒé‡
- **CJK ä¼˜åŒ–** â€” å¯¹ JS å¯†é›†å‹é¡µé¢å›é€€æå– `<title>` + `<meta description>` ä½œä¸ºæ–‡æœ¬æº
- **ä¸å´©æºƒ** â€” æ‰€æœ‰å­ç³»ç»Ÿç‹¬ç«‹è¿è¡Œï¼Œä»»ä¸€å¤±è´¥ä¸å½±å“å…¶ä»–ä¿¡å·ï¼Œé”™è¯¯è®°å½•åˆ° `errors`/`warnings`

## å·²éªŒè¯ç«™ç‚¹

| ç«™ç‚¹ | æ£€æµ‹ç»“æœ | ç½®ä¿¡åº¦ |
|------|----------|--------|
| baidu.com | CN / China | 0.15 (JS é‡é¡µé¢ï¼Œä¿¡å·å°‘ä½†æ­£ç¡®) |
| google.com | US / United States | 0.10 (å…¨çƒåŒ–ç«™ç‚¹ï¼Œä½ä½†æ­£ç¡®) |
| spiegel.de | DE / Germany | 0.64 (TLD + lang + IP + langdetect ä¸€è‡´) |
| yahoo.co.jp | JP / Japan | 0.67 (TLD + lang + IP + LINE + langdetect) |
| yandex.ru | RU / Russia | 0.32 (TLD + IPï¼Œé‡å®šå‘å¯¼è‡´æ–‡æœ¬ä¸è¶³) |

## æ–‡ä»¶ç»“æ„

```
web-region-audience-analyzer/
â”œâ”€â”€ SKILL.md                          # Skill å…ƒæ•°æ®ä¸ä½¿ç”¨è¯´æ˜
â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ analyze_webpage.py            # ä¸»åˆ†æè„šæœ¬ï¼ˆå¯ç‹¬ç«‹è¿è¡Œï¼‰
â””â”€â”€ references/
    â”œâ”€â”€ api-reference.md              # IP-API / NLP Cloud æ¥å£æ–‡æ¡£
    â””â”€â”€ signal-patterns.md            # TLD/ç”µè¯/è´§å¸/ç¤¾äº¤åª’ä½“æ˜ å°„è¡¨
```

## å±€é™æ€§

- **CDN/ä»£ç†** â€” ä½¿ç”¨ CDN çš„ç«™ç‚¹ IP åœ°ç†å®šä½å¯èƒ½åç§»ï¼ˆå·²é€šè¿‡é™æƒç¼“è§£ï¼‰
- **JS æ¸²æŸ“** â€” ä¸æ‰§è¡Œ JavaScriptï¼ŒSPA ç±»ç«™ç‚¹å¯èƒ½æå–ä¸åˆ°æœ‰æ•ˆæ–‡æœ¬
- **å¤šè¯­ç§é¡µé¢** â€” å½“å‰å–ç½®ä¿¡åº¦æœ€é«˜çš„è¯­è¨€ï¼Œä¸åšå¤šè¯­ç§æƒé‡èšåˆ
- **ip-api.com é™é¢‘** â€” å…è´¹ API é™ 45 æ¬¡/åˆ†é’Ÿï¼Œæ‰¹é‡åˆ†æéœ€æ³¨æ„èŠ‚æµ
- **å…¨çƒåŒ–ç«™ç‚¹** â€” `.com` + è‹±è¯­ + US CDN çš„ç»„åˆä¼šå¯¼è‡´ä½ç½®ä¿¡åº¦ï¼ˆè¿™æ˜¯æ­£ç¡®è¡Œä¸ºï¼‰
